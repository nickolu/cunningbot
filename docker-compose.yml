services:
  cunningbot:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - CLIENT_ID=${CLIENT_ID}
      - INVITE_URL=${INVITE_URL}
    volumes:
      - ./bot/app:/app/bot/app
      - ./logs:/app/logs
      - ./generated_images:/app/generated_images
    # Note: Using volumes for the core directory allows state persistence
    # between container restarts without rebuilding the image
    # The specific app_state.json mapping ensures personality settings remain intact
  dailygame:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.daily_game_poster; sleep 600; done"
  rssfeed:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.rss_feed_poster; sleep 600; done"
  rsssummary:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.rss_summary_poster; sleep 600; done"
  breaking-news-validator:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.breaking_news_validator; sleep 120; done"
  trivia-poster:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.trivia_game_poster; sleep 600; done"
  trivia-closer:
    build: .
    restart: unless-stopped
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      - ./bot/app:/app/bot/app
    command: bash -c "while true; do python -m bot.app.tasks.trivia_game_closer; sleep 60; done"
